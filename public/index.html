<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Formulario de Reserva</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker.min.css"
    rel="stylesheet">
  <link rel="stylesheet" href="css/index.css">
  
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm mb-3">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="#">
  <img src="img/logo.png" alt="Logo" height="38" class="me-2 align-middle">
</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarOpciones">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarOpciones">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <button type="button" class="btn btn-outline-light me-2" data-bs-toggle="modal" data-bs-target="#modalModificarReserva">
            Modificar Reserva
          </button>
        </li>
        <li class="nav-item">
          <button type="button" class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#modalCancelarReserva">
            Cancelar Reserva
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <div class="container p-4 shadow">
    <h1 class="mb-4 text-center">Reserva Hora</h1>
    <form id="reservaForm" autocomplete="off">
      <div class="form-section">
        <div class="row g-3 align-items-end">
          <div class="col-md-4">
            <label for="tipoReserva" class="form-label">Tipo de Reserva</label>
            <select class="form-select" id="tipoReserva" required>
              <option value="empresa">Empresa</option>
              <option value="particular">Particular</option>
            </select>
          </div>
          <div class="col-md-4">
            <label for="sucursalId" class="form-label">Sucursal</label>
            <select class="form-select" id="sucursalId" required></select>
          </div>
          <div class="col-md-4">
            <label for="fechaReserva" class="form-label">Fecha</label>
            <input type="date" class="form-control" id="fechaReserva" required>
          </div>
          <div class="col-md-4">
            <label for="horaReserva" class="form-label">Hora</label>
            <select class="form-select" id="horaReserva" required></select>
          </div>
        </div>
      </div>

      <!-- EMPRESA y SOLICITANTE -->
      <div id="empresaFieldset" class="form-section">
        <fieldset class="border p-3 mb-2">
          <legend class="float-none w-auto text-primary fw-bold">Datos de la Empresa</legend>
          <div class="row g-3 align-items-end">
            <div class="col-md-6">
              <label class="form-label">RUT Empresa</label>
              <div class="input-group">
                <input type="text" class="form-control" id="empRUT">
                <button type="button" class="btn btn-secondary" id="buscarEmpresaBtn">Buscar Empresa</button>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Nombre Empresa</label>
              <input type="text" class="form-control" id="empNombre">
            </div>
            <div class="col-md-6">
              <label class="form-label">Dirección Empresa</label>
              <input type="text" class="form-control" id="empDireccion">
            </div>
            <div class="col-md-6">
              <label class="form-label">Giro Empresa</label>
              <input type="text" class="form-control" id="empGiro">
            </div>
          </div>
        </fieldset>
        <fieldset class="border p-3 mt-2">
          <legend class="float-none w-auto text-primary fw-bold">Datos del Solicitante</legend>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Nombre Solicitante</label>
              <input type="text" class="form-control" id="solNombre">
            </div>
            <div class="col-md-6">
              <label class="form-label">Cargo Solicitante</label>
              <input type="text" class="form-control" id="solCargo">
            </div>
            <div class="col-md-6">
              <label class="form-label">Teléfono Solicitante</label>
              <input type="tel" class="form-control" id="solTelefono">
            </div>
            <div class="col-md-6">
              <label class="form-label">Correo Solicitante</label>
              <input type="email" class="form-control" id="solCorreo">
            </div>
          </div>
        </fieldset>
      </div>
      <!-- FIN EMPRESA/SOLICITANTE -->

      <div id="trabajadoresFieldsetEmpresa" class="form-section">
        <fieldset class="border p-3">
          <legend class="float-none w-auto">Trabajadores (Empresa)</legend>
          <div id="trabajadoresContainer"></div>
          <button type="button" class="btn btn-outline-primary mt-3 add-btn" id="addTrabajadorBtn">Agregar
            Trabajador</button>
        </fieldset>
      </div>

      <div id="trabajadorFieldsetParticular" class="form-section d-none">
        <fieldset class="border p-3">
          <legend class="float-none w-auto">Trabajador (Particular)</legend>
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label">Nombre</label>
              <input type="text" class="form-control" id="trabNombre">
            </div>
            <div class="col-md-4">
              <label class="form-label">RUT/Pasaporte</label>
              <input type="text" class="form-control" id="trabRut">
            </div>
            <div class="col-md-2">
              <label class="form-label">Edad</label>
              <input type="number" min="0" class="form-control" id="trabEdad">
            </div>
            <div class="col-md-4">
              <label class="form-label">Cargo</label>
              <input type="text" class="form-control" id="trabCargo">
            </div>
            <div class="col-md-6">
              <label class="form-label">Correo</label>
              <input type="email" class="form-control" id="trabCorreo" required>
            </div>
          </div>
        </fieldset>
      </div>

      <div class="form-section">
        <fieldset class="border p-3">
          <legend class="float-none w-auto">Baterías Médicas</legend>
          <div id="bateriasList" class="row"></div>
        </fieldset>
        <fieldset class="border p-3 mt-2">
          <legend class="float-none w-auto">Exámenes Adicionales</legend>
          <div id="examenesList" class="row"></div>
        </fieldset>
        <fieldset class="border p-3 mt-2">
          <legend class="float-none w-auto">Pruebas de Drogas</legend>
          <div id="pruebasList" class="row"></div>
        </fieldset>
      </div>
      <div class="d-flex justify-content-between align-items-center mt-4">
        <button type="submit" class="btn btn-primary">Crear Reserva</button>
        <button type="button" class="btn btn-success" id="verCalendarioBtn">Ver Calendario</button>
      </div>
      <pre id="crearResult" class="mt-3" style="display:none"></pre>
    </form>
  </div>

  <!-- MODAL Bootstrap para mostrar info reserva -->
  <div class="modal fade" id="modalReservaCreada" tabindex="-1" aria-labelledby="modalReservaLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalReservaLabel">Reserva creada exitosamente</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body" id="modalReservaBody"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="okModalBtn" data-bs-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const apiUrl = 'http://localhost:3000/api';

    // Cargar catálogos
    async function fetchCatalogos() {
      const [suc, bat, exa, pru] = await Promise.all([
        fetch(`${apiUrl}/catalogos/sucursales`).then(r => r.json()),
        fetch(`${apiUrl}/catalogos/baterias`).then(r => r.json()),
        fetch(`${apiUrl}/catalogos/examenes`).then(r => r.json()),
        fetch(`${apiUrl}/catalogos/pruebas`).then(r => r.json())
      ]);
      document.getElementById('sucursalId').innerHTML = suc.map(i => `<option value="${i.id}">${i.nombre}</option>`).join('');
      const mkCheckboxes = (id, items, name) => {
        document.getElementById(id).innerHTML = items.map(i =>
          `<div class="form-check col-md-6"><input class="form-check-input" type="checkbox" name="${name}" value="${i.id}" id="${name}_${i.id}">
            <label class="form-check-label" for="${name}_${i.id}">${i.nombre}</label></div>`
        ).join('');
      };
      mkCheckboxes('bateriasList', bat, 'bateriaMedicaIds');
      mkCheckboxes('examenesList', exa, 'examenAdicionalIds');
      mkCheckboxes('pruebasList', pru, 'pruebaDrogasIds');
    }

    function generarHoras() {
      const horaInicio = 7 * 60 + 30; // 7:30 en minutos
      const horaFin = 17 * 60; // 17:00 en minutos
      const select = document.getElementById('horaReserva');
      select.innerHTML = '';
      for (let min = horaInicio; min <= horaFin; min += 30) {
        const h = String(Math.floor(min / 60)).padStart(2, '0');
        const m = String(min % 60).padStart(2, '0');
        select.innerHTML += `<option value="${h}:${m}">${h}:${m}</option>`;
      }
    }

    function configurarFecha() {
      const fechaInput = document.getElementById('fechaReserva');
      const hoy = new Date();
      fechaInput.min = hoy.toISOString().split('T')[0];
      fechaInput.addEventListener('input', function () {
        const fecha = new Date(this.value + "T00:00:00");
        if (fecha.getDay() === 6 || fecha.getDay() === 0) {
          alert("No se pueden seleccionar sábados ni domingos.");
          this.value = '';
        }
      });
    }

    // Buscar empresa por RUT y autocompletar
    document.getElementById('buscarEmpresaBtn').addEventListener('click', async function () {
      const rut = document.getElementById('empRUT').value.trim();
      if (!rut) {
        alert("Ingrese un RUT para buscar");
        return;
      }
      try {
        const res = await fetch(`${apiUrl}/empresas/buscar?rut=${encodeURIComponent(rut)}`);
        if (res.ok) {
          const empresa = await res.json();
          if (empresa && empresa.nombre) {
            document.getElementById('empNombre').value = empresa.nombre;
            document.getElementById('empDireccion').value = empresa.direccion;
            document.getElementById('empGiro').value = empresa.giro;
          } else {
            alert("Empresa no encontrada");
            document.getElementById('empNombre').value = '';
            document.getElementById('empDireccion').value = '';
            document.getElementById('empGiro').value = '';
          }
        } else {
          alert("Empresa no encontrada");
          document.getElementById('empNombre').value = '';
          document.getElementById('empDireccion').value = '';
          document.getElementById('empGiro').value = '';
        }
      } catch (error) {
        alert("Error buscando empresa");
      }
    });

    // Trabajadores Dinámicos (Empresa)
    function createTrabajadorRow() {
      const row = document.createElement('div');
      row.className = 'row row-trabajador align-items-end g-2';
      row.innerHTML = `
          <div class="col"><input type="text" class="form-control" placeholder="Nombre" required></div>
          <div class="col"><input type="text" class="form-control" placeholder="RUT/Pasaporte" required></div>
          <div class="col"><input type="number" class="form-control" placeholder="Edad" min="0" required></div>
          <div class="col"><input type="text" class="form-control" placeholder="Cargo" required></div>
          <div class="col-auto d-flex align-items-center">
            <button type="button" class="btn btn-danger remove-btn" style="height:38px; width:100%;">-</button>
          </div>
        `;
      row.querySelector('.remove-btn').onclick = function () {
        const container = document.getElementById('trabajadoresContainer');
        if (container.children.length > 1) row.remove();
      };
      return row;
    }

    function toggleSections() {
      const tipo = document.getElementById('tipoReserva').value;
      document.getElementById('empresaFieldset').style.display = (tipo === 'empresa') ? 'block' : 'none';
      document.getElementById('trabajadoresFieldsetEmpresa').style.display = (tipo === 'empresa') ? 'block' : 'none';
      document.getElementById('trabajadorFieldsetParticular').classList.toggle('d-none', tipo !== 'particular');
      const container = document.getElementById('trabajadoresContainer');
      container.innerHTML = '';
      if (tipo === 'empresa' && container.children.length === 0) {
        container.appendChild(createTrabajadorRow());
      }
      const inputCorreo = document.getElementById('trabCorreo');
      if (tipo === 'particular') {
        inputCorreo.setAttribute('required', 'required');
      } else {
        inputCorreo.removeAttribute('required');
      }
    }

    document.getElementById('tipoReserva').addEventListener('change', toggleSections);
    document.getElementById('addTrabajadorBtn').addEventListener('click', () => {
      document.getElementById('trabajadoresContainer').appendChild(createTrabajadorRow());
    });

    // Validación y envío del formulario
    document.getElementById('reservaForm').addEventListener('submit', async e => {
      e.preventDefault();
      const submitBtn = e.target.querySelector('button[type="submit"]');
      submitBtn.disabled = true; // Bloquear para evitar múltiples envíos

      const tipo = document.getElementById('tipoReserva').value;
      const getValue = id => document.getElementById(id).value.trim();

      // Validaciones generales (todos obligatorios menos exámenes y drogas)
      if (!getValue('sucursalId') || !getValue('fechaReserva') || !getValue('horaReserva')) {
        alert("Debes completar todos los campos obligatorios.");
        submitBtn.disabled = false;
        return;
      }

      // Validación de baterías médicas seleccionadas
      const getChecked = name => Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(i => Number(i.value));
      const bateriasSeleccionadas = getChecked('bateriaMedicaIds');
      if (bateriasSeleccionadas.length === 0) {
        alert("Debes seleccionar al menos una batería médica.");
        submitBtn.disabled = false;
        return;
      }

      if (tipo === 'empresa') {
        // Valida empresa
        if (!getValue('empRUT') || !getValue('empNombre') || !getValue('empDireccion') || !getValue('empGiro')) {
          alert("Debes completar todos los datos de la empresa.");
          submitBtn.disabled = false;
          return;
        }
        // Valida solicitante
        if (!getValue('solNombre') || !getValue('solCargo') || !getValue('solTelefono') || !getValue('solCorreo')) {
          alert("Debes completar todos los datos del solicitante.");
          submitBtn.disabled = false;
          return;
        }
        // Valida al menos un trabajador
        const rows = document.querySelectorAll('#trabajadoresContainer .row');
        if (rows.length === 0) {
          alert("Debes agregar al menos un trabajador.");
          submitBtn.disabled = false;
          return;
        }
        let errorTrab = false;
        rows.forEach(row => {
          const inputs = row.querySelectorAll('input');
          if (![0, 1, 2, 3].every(i => inputs[i] && inputs[i].value.trim())) errorTrab = true;
        });
        if (errorTrab) {
          alert("Debes completar todos los datos de los trabajadores.");
          submitBtn.disabled = false;
          return;
        }
      } else {
        // Validar todos los campos de particular
        if (!getValue('trabNombre') || !getValue('trabRut') || !getValue('trabEdad') || !getValue('trabCargo') || !getValue('trabCorreo')) {
          alert("Debes completar todos los datos del trabajador.");
          submitBtn.disabled = false;
          return;
        }
      }

      const fecha = getValue('fechaReserva');
      const hora = getValue('horaReserva');
      const fechaHora = new Date(`${fecha}T${hora}:00`).toISOString();
      const payload = {
        tipoReserva: tipo,
        sucursalId: Number(getValue('sucursalId')),
        fechaHora,
        bateriaMedicaIds: bateriasSeleccionadas,
        examenAdicionalIds: getChecked('examenAdicionalIds'),
        pruebaDrogasIds: getChecked('pruebaDrogasIds')
      };

      if (tipo === 'empresa') {
        payload.empresaInfo = {
          nombre: getValue('empNombre'),
          rut: getValue('empRUT'),
          direccion: getValue('empDireccion'),
          giro: getValue('empGiro')
        };
        payload.solicitanteInfo = {
          nombre: getValue('solNombre'),
          cargo: getValue('solCargo'),
          telefono: getValue('solTelefono'),
          correo: getValue('solCorreo')
        };
        // Trabajadores
        const trabajadores = [];
        const rows = document.querySelectorAll('#trabajadoresContainer .row');
        rows.forEach(row => {
          const inputs = row.querySelectorAll('input');
          trabajadores.push({
            nombre: inputs[0].value,
            rutPasaporte: inputs[1].value,
            edad: Number(inputs[2].value),
            cargo: inputs[3].value
          });
        });
        payload.trabajadorInfo = trabajadores;
      } else {
        payload.trabajadorInfo = {
          nombre: getValue('trabNombre'),
          rutPasaporte: getValue('trabRut'),
          edad: Number(getValue('trabEdad')),
          cargo: getValue('trabCargo'),
          correo: getValue('trabCorreo')
        };
      }
      try {
        const res = await fetch(`${apiUrl}/reservas`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const json = await res.json();
        if (json.error) {
          alert(json.error);
          submitBtn.disabled = false;
          return;
        }
        mostrarModalReserva(json, submitBtn);
      } catch (err) {
        alert("Ocurrió un error al crear la reserva.");
        submitBtn.disabled = false;
      }
    });

    // Mostrar modal y limpiar form correctamente
    function mostrarModalReserva(respuesta, submitBtn) {
      let html = `<div class="alert alert-success"><b>${respuesta.message || 'Reserva creada correctamente.'}</b></div>`;
      if (respuesta.reserva) {
        html += `<hr><b>ID de la reserva:</b> <span class="text-primary">${respuesta.reserva.id}</span><br>`;
        html += `<hr><b>En caso de modificaciones futuras o cancelaciones de esta reserva se solicitará el ID de la reserva</b><br> `;
        html += `<b>Tipo:</b> ${respuesta.reserva.tipoReserva}<br>`;
        html += `<b>Sucursal:</b> ${respuesta.reserva.sucursal?.nombre || '-'}<br>`;
        html += `<b>Fecha y Hora:</b> ${new Date(respuesta.reserva.fechaHora).toLocaleString('es-CL')}<br>`;
        if (respuesta.reserva.empresa) {
          html += `<hr><b>Empresa:</b> ${respuesta.reserva.empresa.nombre}<br>
                <b>RUT:</b> ${respuesta.reserva.empresa.rut}<br>
                <b>Dirección:</b> ${respuesta.reserva.empresa.direccion}<br>
                <b>Giro:</b> ${respuesta.reserva.empresa.giro}<br>`;
        }
        if (respuesta.reserva.solicitante) {
          html += `<hr><b>Solicitante:</b> ${respuesta.reserva.solicitante.nombre}<br>
                <b>Cargo:</b> ${respuesta.reserva.solicitante.cargo}<br>
                <b>Teléfono:</b> ${respuesta.reserva.solicitante.telefono}<br>
                <b>Correo:</b> ${respuesta.reserva.solicitante.correo}<br>`;
        }
        if (respuesta.reserva.bateriasMedicas?.length) {
          html += `<b>Baterías Médicas:</b> ${respuesta.reserva.bateriasMedicas.map(b => b.nombre).join(', ')}<br>`;
        }
        if (respuesta.reserva.examenesAdicionales?.length) {
          html += `<b>Exámenes Adicionales:</b> ${respuesta.reserva.examenesAdicionales.map(e => e.nombre).join(', ')}<br>`;
        }
        if (respuesta.reserva.pruebasDrogas?.length) {
          html += `<b>Pruebas de Drogas:</b> ${respuesta.reserva.pruebasDrogas.map(p => p.nombre).join(', ')}<br>`;
        }
        if (respuesta.reserva.reservasTrabajador?.length) {
          html += `<hr><b>Trabajadores:</b><ul>`;
          html += respuesta.reserva.reservasTrabajador.map(rt =>
            `<li>${rt.trabajador?.nombre ?? ''} (${rt.trabajador?.rutPasaporte ?? ''}) - ${rt.cargo}, Edad: ${rt.edad}</li>`
          ).join('');
          html += `</ul>`;
        }
      }
      document.getElementById('modalReservaBody').innerHTML = html;
      const modal = new bootstrap.Modal(document.getElementById('modalReservaCreada'));
      modal.show();

      document.getElementById('okModalBtn').onclick = function () {
        document.getElementById('reservaForm').reset();
        toggleSections();
        // Si es empresa, deja solo 1 fila vacía
        if (document.getElementById('tipoReserva').value === 'empresa') {
          const container = document.getElementById('trabajadoresContainer');
          container.innerHTML = '';
          container.appendChild(createTrabajadorRow());
        }
        // Limpiar cualquier backdrop residual
        document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());
        // Re-habilita el botón submit y le da el foco
        if (typeof submitBtn !== "undefined" && submitBtn) {
          submitBtn.disabled = false;
          submitBtn.focus(); // Ahora el foco vuelve al botón "Crear Reserva"
        }
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };
    }


    document.getElementById('verCalendarioBtn').addEventListener('click', () => {
      window.location.href = 'calendario-reservas.html';
    });

    document.addEventListener('DOMContentLoaded', () => {
      fetchCatalogos();
      generarHoras();
      configurarFecha();
      toggleSections();
    });


  async function buscarReservaPorId() {
  const reservaId = document.getElementById("reservaId").value.trim();
  if (!reservaId) {
    alert("Ingrese un ID válido.");
    return;
  }

  try {
    const res = await fetch(`/api/reservas/${reservaId}`);
    const data = await res.json();

    if (res.ok) {
      // Validar estado de la reserva antes de redirigir
      if (data.estado === "cancelada") {
        alert("Esta reserva ya fue cancelada y no puede ser modificada.");
        return;
      }
      if (typeof data.modificacionCount !== 'undefined' && data.modificacionCount >= 1) {
        alert("Esta reserva ya fue modificada anteriormente y no puede volver a modificarse.");
        return;
      }
      // Si pasa validación, redirige normalmente
      window.location.href = `/editar-reserva.html?id=${reservaId}`;
    } else {
      alert(data.error || 'No se encontró la reserva.');
    }
  } catch (error) {
    alert("Error al buscar la reserva.");
  }
}


async function validarReservaParaCancelar() {
  const reservaId = document.getElementById("reservaIdCancelar").value.trim();
  const mensaje = document.getElementById("mensajeConfirmacion");
  const btnConfirmar = document.getElementById("btnConfirmarCancelar");

  mensaje.classList.add("d-none");
  btnConfirmar.style.display = "none";

  if (!reservaId) {
    alert("Ingrese un ID válido.");
    return;
  }

  try {
    const res = await fetch(`/api/reservas/${reservaId}`);
    const data = await res.json();

    if (res.ok) {

      if (data.estado === "cancelada") {
        mensaje.textContent = "Esta reserva ya se encuentra cancelada.";
        mensaje.classList.remove("d-none");
      } else {
        mensaje.textContent = "¿Está seguro que desea cancelar esta reserva?";
        mensaje.classList.remove("d-none");
        btnConfirmar.style.display = "inline-block";
        btnConfirmar.onclick = () => cancelarReserva(reservaId);
      }
    } else {
      alert(data.error || 'No se encontró la reserva.');
    }
  } catch (error) {
    alert("Error al buscar la reserva.");
  }
}

async function cancelarReserva(reservaId) {
  try {
    const res = await fetch(`/api/reservas/${reservaId}/cancelar`, {
      method: "PATCH",
    });

    const data = await res.json();
    if (res.ok) {
      alert("Reserva cancelada exitosamente.");
      window.location.reload();
    } else {
      alert(data.error || "Error al cancelar la reserva.");
    }
  } catch (err) {
    console.error(err);
    alert("Error al procesar la cancelación.");
  }
}


  </script>

<!-- Modificar Reserva -->
<div class="modal fade" id="modalModificarReserva" tabindex="-1" aria-labelledby="modalModificarReservaLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalModificarReservaLabel">Modificar Reserva</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <label for="reservaId">Ingrese el ID de la reserva:</label>
        <input type="text" id="reservaId" class="form-control" placeholder="Ej: 123">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" onclick="buscarReservaPorId()">Continuar</button>
      </div>
    </div>
  </div>
</div>

<!-- Cancelar Reserva -->
<div class="modal fade" id="modalCancelarReserva" tabindex="-1" aria-labelledby="modalCancelarReservaLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cancelar Reserva</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <label for="reservaIdCancelar">Ingrese el ID de la reserva:</label>
        <input type="text" id="reservaIdCancelar" class="form-control" placeholder="Ej: 123">
        <p class="mt-3 text-danger d-none" id="mensajeConfirmacion">¿Está seguro que desea cancelar esta reserva?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-warning" id="btnConfirmarCancelar" style="display: none;">Confirmar Cancelación</button>
        <button type="button" class="btn btn-primary" onclick="validarReservaParaCancelar()">Buscar</button>
      </div>
    </div>
  </div>
</div>


</body>

</html>